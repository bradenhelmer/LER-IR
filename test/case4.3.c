for (int k = 0; k < NK; ++k) {
  for (int ii = 0; ii < M; ++i) {
    w[ii] = r * d[ii];
  }
}
